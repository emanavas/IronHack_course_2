<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Manage Users - FoodExpress</title>
    <link rel="stylesheet" type="text/css" href="/style.css" />
    <link rel="stylesheet" type="text/css" href="/lib_style.css" />
    <link rel="icon" type="image/x-icon" href="/assets/favicon.ico" />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    />
    <link
      rel="stylesheet"
      href="/css/admin.css"
    />
  </head>
  <body class="container-fluid mx-0 px-0">
    <%- include('../../partials/navbar') %>

    <main class="row">
      <%- include('../../partials/sidebar_admin') %>

      <div class="col-lg-8 col-md-12 d-flex flex-column p-4 mx-auto">
        <div class="container-fluid">
          <h1 class="mb-4">User Management</h1>

          <% if (locals.success) { %>
          <div class="alert alert-success" role="alert"><%= success %></div>
          <% } %> <% if (locals.error) { %>
          <div class="alert alert-danger" role="alert"><%= error %></div>
          <% } %>

          <div class="d-flex justify-content-end mb-3">
            <a href="/admin/users/create" class="btn btn-primary"
              ><i class="fas fa-plus"></i> Add New User</a
            >
          </div>

          <div class="table-responsive">
            <table class="table table-striped table-hover">
              <thead>
                <tr>
                  <th>ID</th>
                  <th>Email</th>
                  <th>First Name</th>
                  <th>Last Name</th>
                  <th>Role</th>
                  <th>Actions</th>
                </tr>
              </thead>
              <tbody>
                <% if (locals.users && users.length > 0) { %> <% users.forEach(function(user) { %>
                <tr>
                  <td><%= user.userId %></td>
                  <td><%= user.email %></td>
                  <td><%= user.firstName %></td>
                  <td><%= user.lastName %></td>
                  <td><%= user.role %></td>
                  <td>
                    <a
                      href="/admin/users/edit/<%= user.userId %>"
                      class="btn btn-sm btn-warning me-2"
                      ><i class="fas fa-edit"></i> Edit</a
                    >
                    <form
                      action="/admin/users/delete/<%= user.userId %>"
                      method="POST"
                      class="d-inline"
                      onsubmit="return confirm('Are you sure you want to delete this user?');"
                    >
                      <button type="submit" class="btn btn-sm btn-danger">
                        <i class="fas fa-trash"></i> Delete
                      </button>
                    </form>
                  </td>
                </tr>
                <% }); %> <% } else { %>
                <tr>
                  <td colspan="6" class="text-center">No users found.</td>
                </tr>
                <% } %>
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </main>
  </body>
</html>
